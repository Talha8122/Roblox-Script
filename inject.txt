local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer

-- Serverda olması gereken RemoteEvents
local KickEvent = ReplicatedStorage:WaitForChild("KickEvent")
local BanEvent = ReplicatedStorage:WaitForChild("BanEvent")

-- GUI Oluşturma
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AdminKickBanGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 300, 0, 400)
mainFrame.Position = UDim2.new(0.5, -150, 0.5, -200)
mainFrame.BackgroundColor3 = Color3.fromRGB(30,30,30)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui
mainFrame.Active = true
mainFrame.Draggable = true

local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(1, 0, 0, 40)
titleLabel.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
titleLabel.Text = "Admin Kick/Ban Paneli"
titleLabel.TextColor3 = Color3.new(1,1,1)
titleLabel.Font = Enum.Font.SourceSansBold
titleLabel.TextSize = 24
titleLabel.Parent = mainFrame

-- Oyuncu Listesi için ScrollingFrame
local playerListFrame = Instance.new("ScrollingFrame")
playerListFrame.Size = UDim2.new(1, -20, 0, 300)
playerListFrame.Position = UDim2.new(0, 10, 0, 50)
playerListFrame.BackgroundColor3 = Color3.fromRGB(40,40,40)
playerListFrame.BorderSizePixel = 0
playerListFrame.ScrollBarThickness = 8
playerListFrame.Parent = mainFrame

local listLayout = Instance.new("UIListLayout")
listLayout.Padding = UDim.new(0, 5)
listLayout.Parent = playerListFrame

-- Kick ve Ban butonları
local kickButton = Instance.new("TextButton")
kickButton.Size = UDim2.new(0.45, 0, 0, 40)
kickButton.Position = UDim2.new(0.05, 0, 1, -45)
kickButton.Text = "Kick"
kickButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
kickButton.TextColor3 = Color3.new(1,1,1)
kickButton.Font = Enum.Font.SourceSansBold
kickButton.TextSize = 20
kickButton.Parent = mainFrame

local banButton = Instance.new("TextButton")
banButton.Size = UDim2.new(0.45, 0, 0, 40)
banButton.Position = UDim2.new(0.5, 0, 1, -45)
banButton.Text = "Ban"
banButton.BackgroundColor3 = Color3.fromRGB(50, 50, 200)
banButton.TextColor3 = Color3.new(1,1,1)
banButton.Font = Enum.Font.SourceSansBold
banButton.TextSize = 20
banButton.Parent = mainFrame

-- Seçilen oyuncu
local selectedPlayer = nil

local function updatePlayerButtons()
    -- Önce listeyi temizle
    for _, child in ipairs(playerListFrame:GetChildren()) do
        if child:IsA("TextButton") then
            child:Destroy()
        end
    end
    
    -- Oyuncuları listele
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr ~= player then -- Kendini listeleme
            local btn = Instance.new("TextButton")
            btn.Size = UDim2.new(1, 0, 0, 30)
            btn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
            btn.TextColor3 = Color3.new(1,1,1)
            btn.Font = Enum.Font.SourceSans
            btn.TextSize = 18
            btn.Text = plr.Name
            btn.Parent = playerListFrame
            
            btn.MouseButton1Click:Connect(function()
                -- Önce diğer seçilenlerin rengini sıfırla
                for _, otherBtn in ipairs(playerListFrame:GetChildren()) do
                    if otherBtn:IsA("TextButton") then
                        otherBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
                    end
                end
                btn.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
                selectedPlayer = plr
            end)
        end
    end
end

kickButton.MouseButton1Click:Connect(function()
    if selectedPlayer then
        KickEvent:FireServer(selectedPlayer.Name)
    else
        warn("Bir oyuncu seçmelisin!")
    end
end)

banButton.MouseButton1Click:Connect(function()
    if selectedPlayer then
        BanEvent:FireServer(selectedPlayer.Name)
    else
        warn("Bir oyuncu seçmelisin!")
    end
end)

Players.PlayerAdded:Connect(updatePlayerButtons)
Players.PlayerRemoving:Connect(updatePlayerButtons)

updatePlayerButtons()
